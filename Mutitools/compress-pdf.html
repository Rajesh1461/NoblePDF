<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compress PDF - Noble PDF</title>
    <link rel="icon" href="/assets/images/favicon.svg">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .container-card { background: rgba(255,255,255,.95); border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,.1); backdrop-filter: blur(10px); margin: 20px auto; max-width: 1200px; }
        .navbar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px 20px 0 0; }
        .nav-link { color: rgba(255,255,255,.9) !important; }
        .upload-section { background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%); border-radius: 15px; padding: 20px; margin: 20px 0; }
        .upload-area { border: 3px dashed #667eea; border-radius: 15px; padding: 40px; text-align: center; background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%); transition: .3s; cursor: pointer; }
        .upload-area:hover { border-color:#764ba2; background: linear-gradient(135deg, #f0f4ff 0%, #e0e8ff 100%); transform: translateY(-2px); }
        .options { background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%); border-radius: 15px; padding: 20px; margin: 20px 0; }
        .option-group { background: #fff; border:1px solid #e9ecef; border-radius: 10px; padding: 15px; margin: 10px 0; }
        .progress-section { background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%); border-radius: 15px; padding:20px; margin:20px 0; display:none; }
        .success-section { background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-radius: 15px; padding:20px; margin:20px 0; display:none; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border:none; border-radius:25px; padding:12px 30px; font-weight:600; transition:.3s; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(102,126,234,.3); }
        .progress { height:25px; border-radius:15px; background:#e9ecef; }
        .progress-bar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius:15px; }
        .metric { font-weight:600; color:#667eea; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <div class="navbar-nav ms-auto"><a class="nav-link" href="../index.html">Home</a></div>
        </div>
    </nav>

    <div class="container">
        <div class="container-card">
            <div class="text-center p-4">
                <h1 class="display-5 fw-bold text-primary mb-2"><i class="fas fa-compress me-2"></i>Compress PDF</h1>
                <p class="lead text-muted">Reduce file size with configurable compression settings</p>
            </div>

            <div class="upload-section mx-4">
                <h5><i class="fas fa-upload me-2"></i>Upload PDF</h5>
                <div class="upload-area" id="uploadArea">
                    <i class="fas fa-cloud-upload-alt fa-3x text-primary mb-3"></i>
                    <h4>Drag & Drop PDF Here</h4>
                    <p class="text-muted">or click to browse</p>
                    <input type="file" id="fileInput" accept=".pdf" style="display:none;">
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()"><i class="fas fa-folder-open me-2"></i>Choose PDF</button>
                </div>
            </div>

            <div class="options mx-4" id="options" style="display:none;">
                <h5><i class="fas fa-sliders-h me-2"></i>Compression Options</h5>
                <div class="row">
                    <div class="col-md-6">
                        <div class="option-group">
                            <label class="form-label">Compression Level</label>
                            <select class="form-select" id="level">
                                <option value="low">Low (best quality)</option>
                                <option value="medium" selected>Medium (balanced)</option>
                                <option value="high">High (smaller size)</option>
                                <option value="extreme">Extreme (smallest size)</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label class="form-label">Image Quality</label>
                            <input type="range" class="form-range" id="imageQuality" min="30" max="100" value="80">
                            <div>Current: <span class="metric" id="imageQualityVal">80</span>%</div>
                        </div>
                        <div class="option-group">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="downscaleImages" checked>
                                <label class="form-check-label" for="downscaleImages">Downscale large images</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="removeMetadata">
                                <label class="form-check-label" for="removeMetadata">Remove metadata</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="option-group">
                            <label class="form-label">Max Resolution (DPI)</label>
                            <input type="number" class="form-control" id="maxDpi" value="150" min="72" max="600">
                        </div>
                        <div class="option-group">
                            <label class="form-label">Page Range</label>
                            <input type="text" class="form-control" id="pageRange" placeholder="e.g., 1-5,7,10">
                        </div>
                        <div class="option-group">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="optimizeFonts" checked>
                                <label class="form-check-label" for="optimizeFonts">Subset and optimize fonts</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="flattenTransparency">
                                <label class="form-check-label" for="flattenTransparency">Flatten transparency</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center p-3" id="actionRow" style="display:none;">
                <button class="btn btn-primary btn-lg" onclick="simulateCompress()"><i class="fas fa-compress me-2"></i>Compress & Download</button>
            </div>

            <div class="progress-section mx-4" id="progressSection">
                <h5><i class="fas fa-spinner fa-spin me-2"></i>Compressing</h5>
                <div class="progress mb-3"><div class="progress-bar" id="progressFill" style="width:0%"></div></div>
                <p class="text-center" id="progressText">Initializing...</p>
            </div>

            <div class="success-section mx-4" id="successSection">
                <h5><i class="fas fa-check-circle me-2"></i>Compression Complete</h5>
                <p>Original: <span class="metric" id="origSize">—</span> → Compressed: <span class="metric" id="newSize">—</span> (<span class="metric" id="saved">—</span> saved)</p>
                <div class="row">
                    <div class="col-md-6"><button class="btn btn-success w-100 mb-2" onclick="downloadPDF()"><i class="fas fa-download me-2"></i>Download Compressed PDF</button></div>
                    <div class="col-md-6"><button class="btn btn-outline-primary w-100 mb-2" onclick="resetTool()"><i class="fas fa-redo me-2"></i>Compress Another PDF</button></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const options = document.getElementById('options');
        const actionRow = document.getElementById('actionRow');
        const progressSection = document.getElementById('progressSection');
        const successSection = document.getElementById('successSection');

        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', e => { e.preventDefault(); });
        uploadArea.addEventListener('drop', e => { e.preventDefault(); if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]); });
        fileInput.addEventListener('change', e => { if (e.target.files.length) handleFile(e.target.files[0]); });
        document.getElementById('imageQuality').addEventListener('input', e => document.getElementById('imageQualityVal').textContent = e.target.value);

        function handleFile(file){
            if(file.type==='application/pdf' || file.name.endsWith('.pdf')){
                uploadArea.innerHTML = `<div class="mb-2"><i class="fas fa-file-pdf fa-3x text-success"></i></div><h4>${file.name}</h4><p class="text-success">PDF loaded successfully!</p>`;
                options.style.display='block';
                actionRow.style.display='block';
                // mock original size
                document.getElementById('origSize').textContent = formatSize(file.size || 5_000_000);
            } else { alert('Please select a valid PDF file.'); }
        }

        function simulateCompress(){
            progressSection.style.display='block';
            const steps=[
                {t:'Analyzing content...',p:20},
                {t:'Optimizing images...',p:45},
                {t:'Subsetting fonts...',p:65},
                {t:'Rewriting streams...',p:85},
                {t:'Finalizing PDF...',p:100}
            ];
            let i=0; const text=document.getElementById('progressText'); const bar=document.getElementById('progressFill');
            const tick=()=>{ if(i<steps.length){ text.textContent=steps[i].t; bar.style.width=steps[i].p+'%'; i++; setTimeout(tick,900);} else { setTimeout(()=>{ progressSection.style.display='none'; successSection.style.display='block'; const orig=document.getElementById('origSize').textContent; const savedPct=Math.floor(25+Math.random()*45); document.getElementById('saved').textContent=savedPct+'%'; document.getElementById('newSize').textContent = estimateNewSize(orig, savedPct); }, 400);} };
            tick();
        }
        function estimateNewSize(origStr, savedPct){
            const num=parseFloat(origStr); const unit=origStr.includes('MB')?'MB':origStr.includes('KB')?'KB':'Bytes';
            let bytes=num*(unit==='MB'?1024*1024:unit==='KB'?1024:1);
            bytes = bytes*(100-savedPct)/100; return formatSize(bytes);
        }
        function formatSize(bytes){ if(bytes<1024) return Math.round(bytes)+' Bytes'; if(bytes<1024*1024) return (bytes/1024).toFixed(1)+' KB'; return (bytes/1024/1024).toFixed(2)+' MB'; }
        function downloadPDF(){ alert('Download would start here.'); }
        function resetTool(){ location.reload(); }
    </script>
    <script src="/assets/js/layout.js"></script>
</body>
</html>
